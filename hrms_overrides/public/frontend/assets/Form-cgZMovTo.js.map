{"version":3,"file":"Form-cgZMovTo.js","sources":["../../../../frontend/src/views/trip_allowance/Form.vue"],"sourcesContent":["<template>\n\t<ion-page>\n\t\t<ion-content :fullscreen=\"true\">\n\t\t\t<FormView\n\t\t\t\tv-if=\"formFields.data\"\n\t\t\t\tdoctype=\"Expense Claim\"\n\t\t\t\tv-model=\"expenseClaim\"\n\t\t\t\t:isSubmittable=\"true\"\n\t\t\t\t:fields=\"formFields.data\"\n\t\t\t\t:id=\"props.id\"\n\t\t\t\t:tabbedView=\"true\"\n\t\t\t\t:tabs=\"tabs\"\n\t\t\t\t:showAttachmentView=\"false\"\n\t\t\t\t@validateForm=\"validateForm\"\n\t\t\t>\n\t\t\t\t<!-- Child Tables -->\n\t\t\t\t<template #expenses=\"{ isFormReadOnly }\">\n\t\t\t\t\t<div v-show=\"false\">\n\t\t\t\t\t\t<ExpensesTable\n\t\t\t\t\t\t\tv-model:expenseClaim=\"expenseClaim\"\n\t\t\t\t\t\t\t:currency=\"currency\"\n\t\t\t\t\t\t\t:isReadOnly=\"isReadOnly || isFormReadOnly\"\n\t\t\t\t\t\t\t@addExpenseItem=\"addExpenseItem\"\n\t\t\t\t\t\t\t@updateExpenseItem=\"updateExpenseItem\"\n\t\t\t\t\t\t\t@deleteExpenseItem=\"deleteExpenseItem\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\n\t\t\t\t<template #taxes=\"{ isFormReadOnly }\">\n\t\t\t\t\t<div v-show=\"false\">\n\t\t\t\t\t\t<ExpenseTaxesTable\n\t\t\t\t\t\t\tv-model:expenseClaim=\"expenseClaim\"\n\t\t\t\t\t\t\t:currency=\"currency\"\n\t\t\t\t\t\t\t:isReadOnly=\"isReadOnly || isFormReadOnly\"\n\t\t\t\t\t\t\t@addExpenseTax=\"addExpenseTax\"\n\t\t\t\t\t\t\t@updateExpenseTax=\"updateExpenseTax\"\n\t\t\t\t\t\t\t@deleteExpenseTax=\"deleteExpenseTax\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\n\t\t\t\t<template #advances=\"{ isFormReadOnly }\">\n\t\t\t\t\t<div v-show=\"false\">\n\t\t\t\t\t\t<ExpenseAdvancesTable\n\t\t\t\t\t\t\tv-model:expenseClaim=\"expenseClaim\"\n\t\t\t\t\t\t\t:currency=\"currency\"\n\t\t\t\t\t\t\t:isReadOnly=\"isReadOnly || isFormReadOnly\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</FormView>\n\t\t</ion-content>\n\t</ion-page>\n</template>\n\n<script setup>\nimport { IonPage, IonContent } from \"@ionic/vue\"\nimport { createResource } from \"frappe-ui\"\nimport { computed, ref, watch, inject } from \"vue\"\n\nimport FormView from \"@/components/FormView.vue\"\nimport ExpensesTable from \"@/components/ExpensesTable.vue\"\nimport ExpenseTaxesTable from \"@/components/ExpenseTaxesTable.vue\"\nimport ExpenseAdvancesTable from \"@/components/ExpenseAdvancesTable.vue\"\n\nimport { getCompanyCurrency } from \"@/data/currencies\"\nimport { call } from \"frappe-ui\"\n\nconst dayjs = inject(\"$dayjs\")\nconst employee = inject(\"$employee\")\nconst today = dayjs().format(\"YYYY-MM-DD\")\nconst isReadOnly = ref(false)\n\nconst props = defineProps({\n\tid: {\n\t\ttype: String,\n\t\trequired: false,\n\t},\n})\n\nconst tabs = [\n\t{ name: \"Trip Allowance\", lastField: \"cost_center\" },\n]\n\n// object to store form data\nconst expenseClaim = ref({\n  employee: employee.data.name,\n  company: employee.data.company,\n  custom_trip_location: \"\",\n  custom_from: \"\",\n  custom_to: \"\",\n  custom_distance_in_km: 0,\n})\nconst currency = computed(() => getCompanyCurrency(expenseClaim.value.company))\n\n// get form fields\nconst formFields = createResource({\n\turl: \"hrms.api.get_doctype_fields\",\n\tparams: { doctype: \"Expense Claim\" },\n\ttransform(data) {\n\t\tlet fields = getFilteredFields(data)\n\n\t\treturn fields.map((field) => {\n\t\t\t\n\t\t\tif (field.fieldname === \"posting_date\") field.default = today\n\t\t\tif (field.fieldname === \"custom_expense_claim_type\") {\n\t\t\t\tfield.default = \"Trip Allowance\"\n\t\t\t\tfield.read_only = true \n\t\t\t}\n\t\t\treturn applyFilters(field)\n\t\t})\n\t},\n\tonSuccess(_data) {\n\t\texpenseApproverDetails.reload()\n\t\tcompanyDetails.reload()\n\t},\n})\nformFields.reload()\n\n// resources\nconst advances = createResource({\n\turl: \"hrms.hr.doctype.expense_claim.expense_claim.get_advances\",\n\tparams: { employee: employee.data.name },\n\tauto: true,\n\tonSuccess(data) {\n\t\t// set advances\n\t\tif (props.id) {\n\t\t\texpenseClaim.value.advances?.map((advance) => (advance.selected = true))\n\t\t} else {\n\t\t\texpenseClaim.value.advances = []\n\t\t}\n\n\t\treturn data.forEach((advance) => {\n\t\t\tif (\n\t\t\t\tprops.id &&\n\t\t\t\texpenseClaim.value.advances?.some(\n\t\t\t\t\t(entry) => entry.employee_advance === advance.name\n\t\t\t\t)\n\t\t\t)\n\t\t\t\treturn\n\n\t\t\texpenseClaim.value.advances?.push({\n\t\t\t\temployee_advance: advance.name,\n\t\t\t\tpurpose: advance.purpose,\n\t\t\t\tposting_date: advance.posting_date,\n\t\t\t\tadvance_account: advance.advance_account,\n\t\t\t\tadvance_paid: advance.paid_amount,\n\t\t\t\tunclaimed_amount: advance.paid_amount - advance.claimed_amount,\n\t\t\t\tallocated_amount: 0,\n\t\t\t})\n\t\t})\n\t},\n})\n\nconst expenseApproverDetails = createResource({\n\turl: \"hrms.api.get_expense_approval_details\",\n\tparams: { employee: employee.data.name },\n\tonSuccess(data) {\n\t\tsetExpenseApprover(data)\n\t},\n})\n\nconst companyDetails = createResource({\n\turl: \"hrms.api.get_company_cost_center_and_expense_account\",\n\tparams: { company: expenseClaim.value.company },\n\tonSuccess(data) {\n\t\texpenseClaim.value.cost_center = data?.cost_center\n\t\texpenseClaim.value.payable_account =\n\t\t\tdata?.default_expense_claim_payable_account\n\t},\n})\n\n// form scripts\nwatch(\n\t() => expenseClaim.value.employee,\n\t(employee_id) => {\n\t\tif (props.id && employee_id !== employee.data.name) {\n\t\t\t// if employee is not the current user, set form as read only\n\t\t\tsetFormReadOnly()\n\t\t}\n\t}\n)\n\nwatch(\n\t() => props.id && expenseClaim.value.expenses,\n\t(_) => {\n\t\tif (expenseClaim.value.docstatus === 0) {\n\t\t\tadvances.reload()\n\t\t}\n\t}\n)\n\nwatch(\n\t() => expenseClaim.value.advances,\n\t(_value) => {\n\t\tcalculateTotalAdvance()\n\t},\n\t{ deep: true }\n)\n\nwatch(\n\t() => expenseClaim.value.cost_center,\n\t() => {\n\t\texpenseClaim?.value?.expenses?.forEach((expense) => {\n\t\t\texpense.cost_center = expenseClaim.value.cost_center\n\t\t})\n\t}\n)\n\nwatch(\n  () => expenseClaim.value.custom_trip_location,\n  async (trip_location) => {\n    if (!trip_location) return;\n\n    try {\n      console.log(\"Watcher triggered with Trip Location:\", trip_location);\n\n      // Fetch Trip Location record\n      const res = await call(\"frappe.client.get_list\", {\n        doctype: \"Trip Location\",\n        filters: { name: trip_location },\n        fields: [\"from\", \"to\", \"distancekm\"],\n        limit_page_length: 1,\n      });\n\n      console.log(\"Trip Location API Response:\", res);\n\n      if (!res || !res.length) {\n        console.warn(\"Trip Location not found:\", trip_location);\n        expenseClaim.value.custom_from = \"\";\n        expenseClaim.value.custom_to = \"\";\n        expenseClaim.value.custom_distance_in_km = \"\";\n        return;\n      }\n\n      const data = res[0];\n\n      // Update expenseClaim fields reactively\n      expenseClaim.value.custom_from = data.from || \"\";\n      expenseClaim.value.custom_to = data.to || \"\";\n      expenseClaim.value.custom_distance_in_km = data.distancekm || \"\";\n\n      console.log(\"Updated expenseClaim after Trip Location fetch:\", {\n        custom_from: expenseClaim.value.custom_from,\n        custom_to: expenseClaim.value.custom_to,\n        custom_distance_in_km: expenseClaim.value.custom_distance_in_km\n      });\n      // Trigger trip amount calculation\n      calculateTripAmount();\n\n    } catch (err) {\n      console.error(\"Error fetching Trip Location:\", err);\n    }\n  }\n);\n\nwatch(\n  () => expenseClaim.value.custom_holiday,\n  () => {\n    console.log(\"Holiday changed:\", expenseClaim.value.custom_holiday);\n    calculateTripAmount();\n  }\n);\n\nfunction calculateTripAmount() {\n  const employee = expenseClaim.value.employee;\n  const distance = expenseClaim.value.custom_distance_in_km;\n  const is_holiday = expenseClaim.value.custom_holiday === \"Yes\";\n  let trip_amount = 0;\n\n  console.log(\"Calculating trip amount with:\", {\n    employee,\n    distance,\n    is_holiday\n  });\n\n  if (!employee || !distance) {\n    console.warn(\"Employee or distance not set, skipping calculation.\");\n    return;\n  }\n  call(\"frappe.client.get_value\", {\n\tdoctype: \"Employee\",\n\tfilters: { name: expenseClaim.value.employee },\n\tfieldname: \"designation\"\n\t}).then(res => {\n\tconsole.log(\"Raw response:\", res);\n\n\t// Access directly\n\tconst designation = res?.designation;\t\n\n\tconsole.log(\"Extracted designation:\", designation);\n\n\tif (!designation) {\n\t\tconsole.warn(\"Employee designation not found for\", expenseClaim.value.employee);\n\t\treturn;\n\t}\n\n\tconst is_driver = [\"Pick Up Driver\", \"Heavy Truck Driver\"].includes(designation);\n\tconst distance = expenseClaim.value.custom_distance_in_km;\n\tconst is_holiday = expenseClaim.value.custom_holiday === \"Yes\";\n\n\tlet trip_amount = 0;\n\n\tif (is_driver) {\n\t\tif (is_holiday) {\n\t\tif (distance === \"300-500\") trip_amount = 150;\n\t\telse if (distance === \"501-1000\") trip_amount = 175;\n\t\telse if (distance === \"1000+\") trip_amount = 250;\n\t\t} else {\n\t\tif (distance === \"300-500\") trip_amount = 100;\n\t\telse if (distance === \"501-1000\") trip_amount = 125;\n\t\telse if (distance === \"1000+\") trip_amount = 185;\n\t\t}\n\t} else {\n\t\tif (is_holiday) {\n\t\tif (distance === \"300-500\") trip_amount = 100;\n\t\telse if (distance === \"501-1000\") trip_amount = 150;\n\t\telse if (distance === \"1000+\") trip_amount = 200;\n\t\t} else {\n\t\tif (distance === \"300-500\") trip_amount = 75;\n\t\telse if (distance === \"501-1000\") trip_amount = 100;\n\t\telse if (distance === \"1000+\") trip_amount = 140;\n\t\t}\n\t}\n\n\texpenseClaim.value.custom_trip_amount = trip_amount;\n\tconsole.log(\"Calculated trip amount:\", trip_amount);\n\t});\n}\n\n// helper functions\nfunction getFilteredFields(fields) {\n\t// reduce noise from the form view by excluding unnecessary fields\n\t// eg: employee and other details can be fetched from the session user\n\tconst excludeFields = [\n\t\t\"naming_series\",\n\t\t\"task\",\n\t\t\"taxes_and_charges_sb\",\n\t\t\"advance_payments_sb\",\n\t\t\"accounting_dimensions_section\",\n\t\t\"transactions_section\",\n\t\t\"accounting_details\",\t\n\t]\n\tconst extraFields = [\n\t\t\"employee\",\n\t\t\"employee_name\",\n\t\t\"department\",\n\t\t\"remark\",\n\t\t\"is_paid\",\n\t\t\"mode_of_payment\",\n\t\t\"clearance_date\",\n\t\t\"approval_status\",\n\t]\n\n\tif (!props.id) excludeFields.push(...extraFields)\n\n\treturn fields.filter((field) => !excludeFields.includes(field.fieldname))\n}\n\nfunction applyFilters(field) {\n\t\n\n\tif ([\"posting_date\",\"grand_total\"].includes(field.fieldname)) {\n\t\t\tfield.hidden = true\n\t\t}\n\tif (field.fieldname === \"cost_center\") {\n\t\tfield.hidden = true  \n\t}\n\tif (field.fieldname === \"payable_account\") {\n\t\tfield.hidden = true  \n\t}\n\tif (field.fieldname === \"project\") {\n\t\tfield.hidden = true \n\t}\n\tif (field.fieldname === \"payable_account\") {\n\t\tfield.linkFilters = {\n\t\t\treport_type: \"Balance Sheet\",\n\t\t\taccount_type: \"Payable\",\n\t\t\tcompany: expenseClaim.value.company,\n\t\t\tis_group: 0,\n\t\t}\n\t} else if (field.fieldname === \"cost_center\") {\n\t\tfield.linkFilters = {\n\t\t\tcompany: expenseClaim.value.company,\n\t\t\tis_group: 0,\n\t\t}\n\t} else if (field.fieldname === \"project\") {\n\t\tfield.linkFilters = {\n\t\t\tcompany: expenseClaim.value.company,\n\t\t}\n\t}\n\n\treturn field\n}\n\nfunction setExpenseApprover(data) {\n\tconst expense_approver = formFields.data?.find(\n\t\t(field) => field.fieldname === \"expense_approver\"\n\t)\n\texpense_approver.reqd = data?.is_mandatory\n\texpense_approver.documentList = data?.department_approvers.map(\n\t\t(approver) => ({\n\t\t\tlabel: approver.full_name\n\t\t\t\t? `${approver.name} : ${approver.full_name}`\n\t\t\t\t: approver.name,\n\t\t\tvalue: approver.name,\n\t\t})\n\t)\n\n\texpenseClaim.value.expense_approver = data?.expense_approver\n\texpenseClaim.value.expense_approver_name = data?.expense_approver_name\n}\n\nfunction addExpenseItem(item) {\n\tif (!expenseClaim.value.expenses) expenseClaim.value.expenses = []\n\texpenseClaim.value.expenses.push(item)\n\tcalculateTotals()\n\tcalculateTaxes()\n\tallocateAdvanceAmount()\n}\n\nfunction updateExpenseItem(item, idx) {\n\texpenseClaim.value.expenses[idx] = item\n\tcalculateTotals()\n\tcalculateTaxes()\n\tallocateAdvanceAmount()\n}\n\nfunction deleteExpenseItem(idx) {\n\texpenseClaim.value.expenses.splice(idx, 1)\n\tcalculateTotals()\n\tcalculateTaxes()\n\tallocateAdvanceAmount()\n}\n\nfunction addExpenseTax(item) {\n\tif (!expenseClaim.value.taxes) expenseClaim.value.taxes = []\n\texpenseClaim.value.taxes.push(item)\n\tcalculateTaxes()\n\tallocateAdvanceAmount()\n}\n\nfunction updateExpenseTax(item, idx) {\n\texpenseClaim.value.taxes[idx] = item\n\tcalculateTaxes()\n\tallocateAdvanceAmount()\n}\n\nfunction deleteExpenseTax(idx) {\n\texpenseClaim.value.taxes.splice(idx, 1)\n\tcalculateTaxes()\n\tallocateAdvanceAmount()\n}\n\nfunction calculateTotals() {\n\tlet total_claimed_amount = 0\n\tlet total_sanctioned_amount = 0\n\n\texpenseClaim.value?.expenses?.forEach((item) => {\n\t\ttotal_claimed_amount += parseFloat(item.amount)\n\t\ttotal_sanctioned_amount += parseFloat(item.sanctioned_amount)\n\t})\n\n\texpenseClaim.value.total_claimed_amount = total_claimed_amount\n\texpenseClaim.value.total_sanctioned_amount = total_sanctioned_amount\n\tcalculateGrandTotal()\n}\n\nfunction calculateTaxes() {\n\tlet total_taxes_and_charges = 0\n\n\texpenseClaim.value?.taxes?.forEach((item) => {\n\t\tif (item.rate) {\n\t\t\titem.tax_amount =\n\t\t\t\tparseFloat(expenseClaim.value.total_sanctioned_amount) *\n\t\t\t\tparseFloat(item.rate / 100)\n\t\t}\n\n\t\titem.total =\n\t\t\tparseFloat(item.tax_amount) +\n\t\t\tparseFloat(expenseClaim.value.total_sanctioned_amount)\n\t\ttotal_taxes_and_charges += parseFloat(item.tax_amount)\n\t})\n\texpenseClaim.value.total_taxes_and_charges = total_taxes_and_charges\n\tcalculateGrandTotal()\n}\n\nfunction calculateGrandTotal() {\n\texpenseClaim.value.grand_total =\n\t\tparseFloat(expenseClaim.value.total_sanctioned_amount || 0) +\n\t\tparseFloat(expenseClaim.value.total_taxes_and_charges || 0) -\n\t\tparseFloat(expenseClaim.value.total_advance_amount || 0)\n}\n\nfunction allocateAdvanceAmount() {\n\t// allocate reqd advance amount\n\tlet amount_to_be_allocated =\n\t\tparseFloat(expenseClaim.value.total_sanctioned_amount) +\n\t\tparseFloat(expenseClaim.value.total_taxes_and_charges)\n\tlet total_advance_amount = 0\n\n\texpenseClaim?.value?.advances?.forEach((advance) => {\n\t\tif (amount_to_be_allocated >= parseFloat(advance.unclaimed_amount)) {\n\t\t\tadvance.allocated_amount = parseFloat(advance.unclaimed_amount)\n\t\t\tamount_to_be_allocated -= parseFloat(advance.allocated_amount)\n\t\t} else {\n\t\t\tadvance.allocated_amount = amount_to_be_allocated\n\t\t\tamount_to_be_allocated = 0\n\t\t}\n\n\t\tadvance.selected = advance.allocated_amount > 0 ? true : false\n\t\ttotal_advance_amount += parseFloat(advance.allocated_amount)\n\t})\n\texpenseClaim.value.total_advance_amount = total_advance_amount\n\tcalculateGrandTotal()\n}\n\nfunction calculateTotalAdvance() {\n\t// update total advance amount as per user selection & edited values\n\tlet total_advance_amount = 0\n\n\texpenseClaim?.value?.advances?.forEach((advance) => {\n\t\tif (advance.selected) {\n\t\t\ttotal_advance_amount += parseFloat(advance.allocated_amount)\n\t\t}\n\t})\n\texpenseClaim.value.total_advance_amount = total_advance_amount\n\tcalculateGrandTotal()\n}\n\nfunction setFormReadOnly() {\n\tif (expenseClaim.value.expense_approver === employee.data.user_id) return\n\tformFields.data.map((field) => (field.read_only = true))\n\tisReadOnly.value = true\n}\n\nfunction validateForm() {\n\t// set selected advances\n\tif (!expenseClaim?.value?.advances) return\n\n\texpenseClaim.value.advances = expenseClaim?.value?.advances?.filter(\n\t\t(advance) => advance.selected\n\t)\n\texpenseClaim?.value?.expenses?.forEach((expense) => {\n\t\texpense.cost_center = expenseClaim.value.cost_center\n\t})\n}\n</script>\n"],"names":["dayjs","inject","employee","today","isReadOnly","ref","props","__props","tabs","expenseClaim","currency","computed","getCompanyCurrency","formFields","createResource","data","getFilteredFields","field","applyFilters","_data","expenseApproverDetails","companyDetails","advances","_a","advance","entry","_b","setExpenseApprover","watch","employee_id","setFormReadOnly","_","_value","calculateTotalAdvance","expense","trip_location","__async","res","call","calculateTripAmount","err","distance","is_holiday","designation","is_driver","trip_amount","fields","excludeFields","extraFields","expense_approver","approver","addExpenseItem","item","calculateTotals","calculateTaxes","allocateAdvanceAmount","updateExpenseItem","idx","deleteExpenseItem","addExpenseTax","updateExpenseTax","deleteExpenseTax","total_claimed_amount","total_sanctioned_amount","calculateGrandTotal","total_taxes_and_charges","amount_to_be_allocated","total_advance_amount","validateForm","_c","_e","_d"],"mappings":"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"}